<div
	class="bubble-container"
	[class.has-reactions]="message.reactions.like || message.reactions.dislike"
>
	<div
		class="bubble"
		[class.animate]="isFresh"
		[style.background-color]="isMine ? undefined : color"
		[class.solo-emoji]="containsOnlyEmojis(message.content)"
		nz-popover
		[nzPopoverContent]="
			message.myReactions.like || message.myReactions.dislike
				? undefined
				: reactionsPopoverTpl
		"
		nzPopoverTrigger="hover"
		[nzPopoverPlacement]="isMine ? 'left' : 'right'"
		nzPopoverOverlayClassName="reactions-popover"
		[ngxVibration]="vibrationConfig.soft"
	>
		<div [textContent]="message.content"></div>
		<ng-template #reactionsPopoverTpl>
			<div class="reactions">
				<div
					class="reaction"
					*ngIf="!message.myReactions.dislike"
					(click)="toggleReaction(message, 'like')"
					[ngxVibration]="vibrationConfig.strong"
				>
					👍
				</div>
				<div
					class="reaction"
					*ngIf="!message.myReactions.like"
					(click)="toggleReaction(message, 'dislike')"
					[ngxVibration]="vibrationConfig.strong"
				>
					👎
				</div>
			</div>
		</ng-template>
	</div>
	<div class="reaction-icons-container">
		<div
			class="reaction-icon"
			*ngIf="message.reactions.like as reactions"
			[nz-tooltip]="reactionTooltipTpl"
			nzTooltipOverlayClassName="reaction-tooltip"
			[class.i-did]="message.myReactions.like"
			(click)="message.myReactions.like ? toggleReaction(message, 'like') : undefined"
			[ngxVibration]="vibrationConfig.normal"
		>
			👍
			<div class="multiplier" *ngIf="reactions.length > 1">
				{{ reactions.length }}
			</div>
			<ng-template #reactionTooltipTpl>
				<span class="nowrap">
					<span style="padding-right: 3px"> 👍 </span>
					par
				</span>
				<span>
					{{ printReactionsNicknames(reactions) | async }}
				</span>
			</ng-template>
		</div>

		<div
			class="reaction-icon"
			*ngIf="message.reactions.dislike as reactions"
			[nz-tooltip]="reactionTooltipTpl"
			nzTooltipOverlayClassName="reaction-tooltip"
			[class.i-did]="message.myReactions.dislike"
			(click)="message.myReactions.dislike ? toggleReaction(message, 'dislike') : undefined"
			[ngxVibration]="vibrationConfig.normal"
		>
			👎
			<div class="multiplier" *ngIf="reactions.length > 1">
				{{ reactions.length }}
			</div>
			<ng-template #reactionTooltipTpl>
				<span class="nowrap">
					<span style="padding-right: 3px"> 👎 </span>
					par
				</span>
				<span>
					{{ printReactionsNicknames(reactions) | async }}
				</span>
			</ng-template>
		</div>
	</div>
</div>
